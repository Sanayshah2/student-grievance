{% extends 'grievance/base.html' %}
{% load crispy_forms_tags %}
{% block content %}
{% include 'grievance/studentsidebar.html' %}
<style>
  .karo:hover
  {
    color: whitesmoke;

  }


</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Counter-Up/1.0.0/jquery.counterup.min.js" integrity="sha256-JtQPj/3xub8oapVMaIijPNoM0DHoAtgh/gwFYuN5rik=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js" integrity="sha256-jDnOKIOq2KNsQZTcBTEnsp76FnfMEttF6AV2DF2fFNE=" crossorigin="anonymous"></script>
        

        
        

      

<!--Content from here-->
<div class="content">
  <h3  style="font-weight: bold;;margin-top: 30px;" class="">College feed</h3>
    <div style="border-bottom: 3px solid #0D98BA;width:30%;;margin-bottom: 20px;" class=""></div>
    {% if complains %}
    {% for p in complains %}
    <div style="margin-bottom: 20px;margin-top: 30px;;" class="" >
    <div class="card-feed" style="background-color: lightgray">
      <h6 style="font-weight: bold;margin-bottom: 15px;color: black;">{{p.complain_heading}}</h6>
      <div style="border-bottom: 1px solid black;margin-bottom:10px ;margin-top:10px ;"></div>
      <p style="color: black;">{{p.complain_content}}</p>  

    </div>
    <div style="margin: 10px;margin-left: 12px;">
    <span id="button{{p.id}}">
      <a id="likebutton"   name="cid" value="{{p.id}}"  href={% url 'likecomplain' %} style="margin-right: 8px;font-size: 25px;" >
        {% if user in p.likes.all %}
            <i class="fas fa-thumbs-up" style="color: #0D98BA;">
        {% else %}
            <i class="far fa-thumbs-up" style="color: darkgray;">
        {% endif %}
          </i>
        </a>
     
      <span  style="font-weight: bold;">{{p.total_likes}}</span></span>
    </div>
    <div style="margin-left: 10px;" >    
      <small style="">{{p.date_posted|date:"M d, Y"}}</small><br>
      <small style="color: gray;">For: {% if p.branch %}{{p.branch}} Branch{% else %}{{p.related_to}}{% endif %}</small>
  <small>
      
      {% if p.status == 'Solved' %}
      <p style="color: green;font-weight: bold;" >{{p.status}}</p>
      {% elif p.status == 'Rejected' %}
      <p style="color: red;font-weight: bold;" >{{p.status}}</p>
      {% elif p.status == 'In Progress' %}
      <p style="color:rgb(168, 168, 28);font-weight: bold;" >{{p.status}}</p>
      {% else %}
      <p style="font-weight: bold;" >{{p.status}}</p>
      {% endif %}
    
    </small>
  </div>

  </div>
  <hr>
    {% endfor %}
    {% else %}
    <p style="font-style: italic;">No complains to display</p>
    {% endif %}

</div>




   
    


<script type="text/javascript">

  $(document).on('click','#likebutton',function(event){
    event.preventDefault();
    var pk = $(this).attr('value');
    $.ajax({
      type:'GET',
      url:'{% url "likecomplain" %}',
      data:{'cid': pk,

      },
      beforeSend:function(xhr){
        $('#button' + pk).html('');
      },
      success:function(response){
        
        $('#button' + pk).load(location.href + " #button" + pk);
      },
      error:function(response){
        alert("Error");
      }

    });

  });



</script>

{% endblock content %}